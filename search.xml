<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2022/08/18/chao-ju-xia-zai-dai-ma-ji-qi-yu-dao-wen-ti/"/>
      <url>/2022/08/18/chao-ju-xia-zai-dai-ma-ji-qi-yu-dao-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="该项目起因"><a href="#该项目起因" class="headerlink" title="该项目起因"></a>该项目起因</h2><p>因为家里人想要听潮剧的音频，而各大音乐网站又缺少对潮剧的资源支持，于是便尝试在冷门网站上寻找，发现九酷网站有较多的潮剧资源，但由于其简陋的界面和其缺少下载功能，便尝试通过爬虫来进行爬取</p><h2 id="问题处理过程"><a href="#问题处理过程" class="headerlink" title="问题处理过程"></a>问题处理过程</h2><p>首先尝试最基本的请求下载，用request直接请求url，在源代码找不到音频的播放网址，于是便进入开发者模式筛选出音频的文件直接访问发现其出现了403的返回，在对headers的观察后发现原先我自定义的headers缺少了referer，由此可看出该网址需要满足在本域请求，跨域请求会被禁止，为了避免其他由于headers出现的问题，便将headers完善的和浏览器一致，又考虑在源代码处没有音频的url，则考虑其应该是ajax的形式加载，于是便筛选xhr文件发现其playlist.php出现了包含音频网址的json格式，但我对其进行get请求后发现返回空白，在浏览器直接访问其网址也显示空白，后来仔细看给出的信息发现该请求是post请求，直接用get请求会返回不一样的界面</p><h2 id="代码实现过程"><a href="#代码实现过程" class="headerlink" title="代码实现过程"></a>代码实现过程</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">file = <span class="string">"D:\\Desktop\\潮剧下载"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(file):</span><br><span class="line">    os.mkdir(file)</span><br><span class="line">os.chdir(file)</span><br><span class="line"></span><br><span class="line">cookies = {</span><br><span class="line">    <span class="string">'tt'</span>: <span class="string">'ok'</span>,</span><br><span class="line">    <span class="string">'cc'</span>: <span class="string">'ok'</span>,</span><br><span class="line">    <span class="string">'pp'</span>: <span class="string">'ok'</span>,</span><br><span class="line">    <span class="string">'_gid'</span>: <span class="string">'GA1.2.192858228.1660697434'</span>,</span><br><span class="line">    <span class="string">'Hm_lvt_2698d85c1eaff072c02e1fb3b945eaff'</span>: <span class="string">'1660697836'</span>,</span><br><span class="line">    <span class="string">'jpvolume'</span>: <span class="string">'0.738'</span>,</span><br><span class="line">    <span class="string">'tmp_addplay'</span>: <span class="string">''</span>,</span><br><span class="line">    <span class="string">'Hm_lvt_a5de315acb973b8e6da83458c9e456d3'</span>: <span class="string">'1660181157,1660697423,1660722528,1660786572'</span>,</span><br><span class="line">    <span class="string">'_gat_gtag_UA_83639769_5'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'ff'</span>: <span class="string">'ok'</span>,</span><br><span class="line">    <span class="string">'l_music'</span>: <span class="string">'934435/934408/42620/934478/934477/859925/888053/934351/934520/934284/860206/934504l_end'</span>,</span><br><span class="line">    <span class="string">'visit_nums'</span>: <span class="string">'2'</span>,</span><br><span class="line">    <span class="string">'shows'</span>: <span class="string">'ok'</span>,</span><br><span class="line">    <span class="string">'jk_ifplay'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'_ga_4BBS961T5P'</span>: <span class="string">'GS1.1.1660786581.8.1.1660786600.0.0.0'</span>,</span><br><span class="line">    <span class="string">'_ga'</span>: <span class="string">'GA1.2.83816721.1660181158'</span>,</span><br><span class="line">    <span class="string">'Hm_lpvt_a5de315acb973b8e6da83458c9e456d3'</span>: <span class="string">'1660786600'</span>,</span><br><span class="line">    <span class="string">'jk_addplay'</span>: <span class="string">'934408/934409/934410/934411/934412/934413/934414/934415/934416/934417/934418/934419/934420/934421/934422/934423/934424/934425/934426/934427/934428/934431/934432/934433/934435/934436/934437/934438/934439/934440/934441/934442/934443/934444/934445/934446/934447/934448/934449/934450/934504/934284/934539/934534/934351/934451/934505/934257/934520/934268/934276/934312/934401/934429/934430/934434/934460/934462/934473/934476/934481/934484/934499/934245/934503/934506/934510/934527/934274/934275/934546/934319/934396/934400/934402/934403/934404/934405/934406/934407/934452/934453/934454/934455/934456/934457/934458/934459/934461/934463/934464/934465/934466/934467/934468/934469/934470/934471/934472/934474/934475/934477/934478/934479/934480/934482/934483/934485/934486/934487/934488/934489/934490/934491/934492/934237/934493/934238/934494/934239'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">headers = {</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'*/*'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6'</span>,</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span>,</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded; charset=UTF-8'</span>,</span><br><span class="line">    <span class="string">'Origin'</span>: <span class="string">'https://www.9ku.com'</span>,</span><br><span class="line">    <span class="string">'Referer'</span>: <span class="string">'https://www.9ku.com/play/934435.htm'</span>,</span><br><span class="line">    <span class="string">'Sec-Fetch-Dest'</span>: <span class="string">'empty'</span>,</span><br><span class="line">    <span class="string">'Sec-Fetch-Mode'</span>: <span class="string">'cors'</span>,</span><br><span class="line">    <span class="string">'Sec-Fetch-Site'</span>: <span class="string">'same-origin'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36 Edg/104.0.1293.54'</span>,</span><br><span class="line">    <span class="string">'X-Requested-With'</span>: <span class="string">'XMLHttpRequest'</span>,</span><br><span class="line">    <span class="string">'sec-ch-ua'</span>: <span class="string">'"Chromium";v="104", " Not A;Brand";v="99", "Microsoft Edge";v="104"'</span>,</span><br><span class="line">    <span class="string">'sec-ch-ua-mobile'</span>: <span class="string">'?0'</span>,</span><br><span class="line">    <span class="string">'sec-ch-ua-platform'</span>: <span class="string">'"Windows"'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">data = {</span><br><span class="line">    <span class="string">'ids'</span>: <span class="string">'934408,934409,934410,934411,934412,934413,934414,934415,934416,934417,934418,934419,934420,934421,934422,934423,934424,934425,934426,934427,934428,934431,934432,934433,934435,934436,934437,934438,934439,934440,934441,934442,934443,934444,934445,934446,934447,934448,934449,934450,934504,934284,934539,934534,934351,934451,934505,934257,934520,934268,934276,934312,934401,934429,934430,934434,934460,934462,934473,934476,934481,934484,934499,934245,934503,934506,934510,934527,934274,934275,934546,934319,934396,934400,934402,934403,934404,934405,934406,934407,934452,934453,934454,934455,934456,934457,934458,934459,934461,934463,934464,934465,934466,934467,934468,934469,934470,934471,934472,934474,934475,934477,934478,934479,934480,934482,934483,934485,934486,934487,934488,934489,934490,934491,934492,934237,934493,934238,934494,934239'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">response = requests.post(<span class="string">'https://www.9ku.com/playlist.php'</span>, cookies=cookies, headers=headers, data=data)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> response.json():</span><br><span class="line">    url = i[<span class="string">'wma'</span>]</span><br><span class="line">    title = i[<span class="string">'mname'</span>]</span><br><span class="line">    <span class="comment"># print(url,title) </span></span><br><span class="line">    response_final = requests.get(url,headers=headers)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(title + <span class="string">'.mp3'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(response_final.content)</span><br><span class="line">    <span class="built_in">print</span>(title + <span class="string">"正在下载中"</span>)</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/07/19/markdown-yong-fa/"/>
      <url>/2022/07/19/markdown-yong-fa/</url>
      
        <content type="html"><![CDATA[<p>Markdown 用法</p><h1 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h1><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">一级标题 # </span><br><span class="line">二级标题 ##</span><br><span class="line">三级标题 ###</span><br></pre></td></tr></tbody></table></figure><h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><h2 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- </span><br><span class="line">.</span><br></pre></td></tr></tbody></table></figure><h2 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.</span><br></pre></td></tr></tbody></table></figure><h1 id="图片与超链接"><a href="#图片与超链接" class="headerlink" title="图片与超链接"></a>图片与超链接</h1><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">图片：</span><br><span class="line">![图片名称](url)</span><br><span class="line">超链接：</span><br><span class="line">[所要链接的字](url)</span><br><span class="line">&lt;a href="超链接地址" target="_blank"&gt;超链接名&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><h2 id="自动目录"><a href="#自动目录" class="headerlink" title="自动目录"></a>自动目录</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[TOC]</span><br><span class="line">在你需要添加目录的地方添加，则会自动生成目录</span><br></pre></td></tr></tbody></table></figure><h2 id="手动目录"><a href="#手动目录" class="headerlink" title="手动目录"></a>手动目录</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;a name="这里加入你对这块链接的id，比如test_1"&gt;&lt;/a&gt;</span><br><span class="line">在需要链接的地方加入</span><br><span class="line">[显示的名称](#&lt;a&gt;标签里的name属性)</span><br><span class="line">比如[1.1test](#test_1.1),在目录加入，则会链接到&lt;a&gt;标签中name属性的地方</span><br><span class="line"></span><br><span class="line">nbsp&amp;</span><br><span class="line">example：</span><br><span class="line"># OutLine</span><br><span class="line">[1.测试](#test_1)</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">&lt;a name="test_1"&gt;&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure><p>未完待续…</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
